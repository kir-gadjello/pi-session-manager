# ä¼šè¯åˆ—è¡¨é¡¹æ”¹è¿›æ–¹æ¡ˆ

## é—®é¢˜åˆ†æ

ç”¨æˆ·åé¦ˆçš„é—®é¢˜ï¼š
1. **è§†è§‰é—®é¢˜**ï¼šçœ‹èµ·æ¥å¾ˆå‚»ã€ä¸ç²¾è‡´ã€éš¾çœ‹
2. **ä¿¡æ¯é‡å°‘**ï¼šç¼ºå°‘å…³é”®ä¿¡æ¯
3. **åŠŸèƒ½ç¼ºå¤±**ï¼šæ²¡æ³•çœ‹æœ€åä¸€æ¬¡èŠå¤©å†…å®¹

## æ”¹è¿›æ–¹æ¡ˆ

### ç¬¬ä¸€é˜¶æ®µï¼šUI è§†è§‰æ”¹è¿›ï¼ˆå·²å®Œæˆï¼‰

#### 1. å¡ç‰‡å¼è®¾è®¡
- **å›¾æ ‡åŒºåŸŸ**ï¼šæ·»åŠ åœ†è§’èƒŒæ™¯çš„å›¾æ ‡å®¹å™¨
  - é€‰ä¸­çŠ¶æ€ï¼šä¸»é¢˜è‰²èƒŒæ™¯ + ä¸»é¢˜è‰²å›¾æ ‡
  - æœªé€‰ä¸­çŠ¶æ€ï¼šç°è‰²èƒŒæ™¯ + ç°è‰²å›¾æ ‡
  - Hover çŠ¶æ€ï¼šæ¸å˜åˆ°ä¸»é¢˜è‰²

- **å·¦ä¾§è¾¹æ¡†æŒ‡ç¤ºå™¨**ï¼š
  - é€‰ä¸­çŠ¶æ€ï¼š2px ä¸»é¢˜è‰²è¾¹æ¡†
  - æœªé€‰ä¸­çŠ¶æ€ï¼š2px é€æ˜è¾¹æ¡†
  - æä¾›æ¸…æ™°çš„è§†è§‰åé¦ˆ

#### 2. ä¿¡æ¯å±‚æ¬¡ä¼˜åŒ–
- **æ ‡é¢˜è¡Œ**ï¼š
  - å­—ä½“åŠ ç²—ï¼ˆfont-semiboldï¼‰
  - æ”¯æŒ 2 è¡Œæ˜¾ç¤ºï¼ˆline-clamp-2ï¼‰
  - ä¼˜å…ˆæ˜¾ç¤ºä¼šè¯åç§°ï¼Œå…¶æ¬¡æ˜¯ç¬¬ä¸€æ¡æ¶ˆæ¯

- **æ¶ˆæ¯é¢„è§ˆ**ï¼š
  - å½“æ²¡æœ‰ä¼šè¯åç§°æ—¶ï¼Œæ˜¾ç¤º first_message ä½œä¸ºé¢„è§ˆ
  - 2 è¡Œæˆªæ–­ï¼ˆline-clamp-2ï¼‰
  - æ›´å¥½çš„è¡Œé«˜ï¼ˆleading-relaxedï¼‰

- **ç›®å½•ä¿¡æ¯**ï¼š
  - æ·»åŠ æ–‡ä»¶å¤¹å›¾æ ‡
  - ä½¿ç”¨ç­‰å®½å­—ä½“ï¼ˆfont-monoï¼‰
  - æ™ºèƒ½æˆªæ–­ï¼šåªæ˜¾ç¤ºæœ€åä¸¤çº§ç›®å½•ï¼ˆ.../parent/childï¼‰

- **å…ƒä¿¡æ¯è¡Œ**ï¼š
  - æ—¶é’Ÿå›¾æ ‡ + ç›¸å¯¹æ—¶é—´
  - æ–‡ä»¶å›¾æ ‡ + æ¶ˆæ¯æ•°é‡
  - é€‰ä¸­çŠ¶æ€æ—¶ä½¿ç”¨ä¸»é¢˜è‰²

#### 3. äº¤äº’æ”¹è¿›
- **è¿‡æ¸¡åŠ¨ç”»**ï¼š
  - æ·»åŠ  duration-200 çš„å¹³æ»‘è¿‡æ¸¡
  - Hover çŠ¶æ€æ›´æ˜æ˜¾ï¼ˆbg-accent/50ï¼‰
  - é€‰ä¸­çŠ¶æ€æ›´çªå‡ºï¼ˆbg-accent/80ï¼‰

- **åˆ é™¤æŒ‰é’®**ï¼š
  - æ›´å¤§çš„ç‚¹å‡»åŒºåŸŸï¼ˆp-1.5ï¼‰
  - æ›´æ˜æ˜¾çš„ Hover æ•ˆæœï¼ˆçº¢è‰²èƒŒæ™¯ + çº¢è‰²æ–‡å­—ï¼‰
  - åœ†è§’è®¾è®¡ï¼ˆrounded-mdï¼‰

#### 4. é—´è·ä¼˜åŒ–
- å¤–è¾¹è·ï¼špx-4 py-3.5ï¼ˆæ›´å®½æ¾ï¼‰
- å†…éƒ¨é—´è·ï¼šgap-3ï¼ˆå›¾æ ‡å’Œå†…å®¹ä¹‹é—´ï¼‰
- å‚ç›´é—´è·ï¼šspace-y-2ï¼ˆå†…å®¹åŒºåŸŸï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šåç«¯æ•°æ®å¢å¼ºï¼ˆå¾…å®ç°ï¼‰

#### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶
1. **src-tauri/src/models.rs**
   ```rust
   pub struct SessionInfo {
       // ... ç°æœ‰å­—æ®µ
       pub last_message: String,        // æ–°å¢ï¼šæœ€åä¸€æ¡æ¶ˆæ¯
       pub last_message_role: String,   // æ–°å¢ï¼šæœ€åä¸€æ¡æ¶ˆæ¯çš„è§’è‰²
   }
   ```

2. **src-tauri/src/scanner.rs**
   ```rust
   pub fn parse_session_info(path: &Path) -> Result<SessionInfo, String> {
       // ... ç°æœ‰ä»£ç 
       let mut last_message = String::new();
       let mut last_message_role = String::new();
       
       for line in &lines[1..] {
           // ... è§£æé€»è¾‘
           if entry["type"] == "message" {
               let role = entry["message"]["role"].as_str().unwrap_or("");
               if role == "user" || role == "assistant" {
                   let text = extract_message_text(&entry);
                   if !text.is_empty() {
                       last_message = text.chars().take(150).collect();
                       last_message_role = role.to_string();
                   }
               }
           }
       }
       
       // ... è¿”å› SessionInfo
   }
   ```

3. **src-tauri/src/sqlite_cache.rs**
   - æ›´æ–°æ•°æ®åº“ schemaï¼Œæ·»åŠ  last_message å’Œ last_message_role å­—æ®µ
   - æ›´æ–° upsert_session å’ŒæŸ¥è¯¢é€»è¾‘

4. **src/types.ts**
   ```typescript
   export interface SessionInfo {
       // ... ç°æœ‰å­—æ®µ
       last_message?: string
       last_message_role?: string
   }
   ```

5. **src/components/SessionList.tsx**
   ```tsx
   {/* æœ€åä¸€æ¡æ¶ˆæ¯é¢„è§ˆ */}
   {session.last_message && (
     <div className="flex items-start gap-2">
       {session.last_message_role === 'user' ? (
         <User className="h-3 w-3 text-blue-500 flex-shrink-0 mt-0.5" />
       ) : (
         <Bot className="h-3 w-3 text-green-500 flex-shrink-0 mt-0.5" />
       )}
       <p className="text-xs text-muted-foreground/80 line-clamp-2 leading-relaxed">
         {session.last_message}
       </p>
     </div>
   )}
   ```

## å®ç°æ•ˆæœå¯¹æ¯”

### æ”¹è¿›å‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¬ ä¼šè¯æ ‡é¢˜æˆ–ç¬¬ä¸€æ¡æ¶ˆæ¯              â”‚
â”‚    /path/to/directory               â”‚
â”‚    ğŸ“… 2å°æ—¶å‰ Â· ğŸ“„ 15               â”‚
â”‚                                ğŸ—‘ï¸  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ”¹è¿›åï¼ˆç¬¬ä¸€é˜¶æ®µï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”ƒ [ğŸ’¬] ä¼šè¯æ ‡é¢˜                      â”‚
â”‚ â”ƒ      ç¬¬ä¸€æ¡æ¶ˆæ¯çš„é¢„è§ˆå†…å®¹...       â”‚
â”‚ â”ƒ      å¯ä»¥æ˜¾ç¤ºä¸¤è¡Œï¼Œæä¾›æ›´å¤šä¸Šä¸‹æ–‡  â”‚
â”‚ â”ƒ                                    â”‚
â”‚ â”ƒ      ğŸ“ .../parent/directory       â”‚
â”‚ â”ƒ      ğŸ• 2å°æ—¶å‰ â€¢ ğŸ“„ 15 æ¡æ¶ˆæ¯  ğŸ—‘ï¸ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ”¹è¿›åï¼ˆç¬¬äºŒé˜¶æ®µ - å¾…å®ç°ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”ƒ [ğŸ’¬] ä¼šè¯æ ‡é¢˜                      â”‚
â”‚ â”ƒ                                    â”‚
â”‚ â”ƒ      ğŸ‘¤ ç”¨æˆ·: æœ€åä¸€æ¡ç”¨æˆ·æ¶ˆæ¯...  â”‚
â”‚ â”ƒ      æˆ–                            â”‚
â”‚ â”ƒ      ğŸ¤– åŠ©æ‰‹: æœ€åä¸€æ¡åŠ©æ‰‹å›å¤...  â”‚
â”‚ â”ƒ                                    â”‚
â”‚ â”ƒ      ğŸ“ .../parent/directory       â”‚
â”‚ â”ƒ      ğŸ• 2å°æ—¶å‰ â€¢ ğŸ“„ 15 æ¡æ¶ˆæ¯  ğŸ—‘ï¸ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯ç»†èŠ‚

### é¢œè‰²ç³»ç»Ÿ
- ä¸»é¢˜è‰²ï¼š`text-primary`, `bg-primary/10`
- é™éŸ³è‰²ï¼š`text-muted-foreground`, `bg-muted/50`
- å¼ºè°ƒè‰²ï¼š`bg-accent/80`ï¼ˆé€‰ä¸­ï¼‰ï¼Œ`bg-accent/50`ï¼ˆhoverï¼‰
- è¾¹æ¡†è‰²ï¼š`border-border/20`

### å“åº”å¼è®¾è®¡
- ä½¿ç”¨ `line-clamp-2` ç¡®ä¿æ–‡æœ¬ä¸ä¼šè¿‡é•¿
- ä½¿ç”¨ `truncate` å¤„ç†å•è¡Œæ–‡æœ¬
- ä½¿ç”¨ `min-w-0` ç¡®ä¿ flex å­å…ƒç´ å¯ä»¥æ­£ç¡®æ”¶ç¼©

### å¯è®¿é—®æ€§
- ä¿ç•™æ‰€æœ‰ title å±æ€§
- ä¿ç•™é”®ç›˜å¯¼èˆªæ”¯æŒ
- ä¿ç•™ ARIA æ ‡ç­¾

## æµ‹è¯•å»ºè®®

1. **è§†è§‰æµ‹è¯•**ï¼š
   - æ£€æŸ¥ä¸åŒé•¿åº¦çš„ä¼šè¯åç§°
   - æ£€æŸ¥ä¸åŒé•¿åº¦çš„ç›®å½•è·¯å¾„
   - æ£€æŸ¥é€‰ä¸­/æœªé€‰ä¸­çŠ¶æ€
   - æ£€æŸ¥ hover æ•ˆæœ

2. **åŠŸèƒ½æµ‹è¯•**ï¼š
   - ç‚¹å‡»ä¼šè¯é¡¹æ˜¯å¦æ­£ç¡®é€‰ä¸­
   - åˆ é™¤æŒ‰é’®æ˜¯å¦æ­£å¸¸å·¥ä½œ
   - æœç´¢è¿‡æ»¤æ˜¯å¦æ­£å¸¸

3. **æ€§èƒ½æµ‹è¯•**ï¼š
   - å¤§é‡ä¼šè¯ï¼ˆ1000+ï¼‰çš„æ¸²æŸ“æ€§èƒ½
   - æ»šåŠ¨æµç•…åº¦

## åç»­ä¼˜åŒ–å»ºè®®

1. **è™šæ‹Ÿæ»šåŠ¨**ï¼šå½“ä¼šè¯æ•°é‡è¶…è¿‡ 100 æ—¶ï¼Œä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æå‡æ€§èƒ½
2. **æ‡’åŠ è½½**ï¼šåˆ†æ‰¹åŠ è½½ä¼šè¯æ•°æ®
3. **ç¼“å­˜ä¼˜åŒ–**ï¼šç¼“å­˜å·²æ¸²æŸ“çš„ä¼šè¯é¡¹
4. **åŠ¨ç”»ä¼˜åŒ–**ï¼šæ·»åŠ è¿›å…¥/é€€å‡ºåŠ¨ç”»
5. **ä¸»é¢˜æ”¯æŒ**ï¼šç¡®ä¿åœ¨æ·±è‰²/æµ…è‰²ä¸»é¢˜ä¸‹éƒ½å¥½çœ‹
